# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** [邵星宇] 

**学号：** [20231050032] 

**完成日期：** [2025.6.11]

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

[描述显式差分法的基本思想、离散化过程和稳定性条件]
基本思想：离散化求解微分方程，利用迭代的方法，下一时刻的值由上一时刻的值计算出，无需求解方程组，适合含时演化的问题求解。分别设置时间步长和空间步长，一阶导采用线性近似，二阶导采用中心差分，然后将微分方程构建成差分方程。需要在时间步长小于空间步长的情况下，才可以实现稳定性，当稳定性参数大于0.5时，就会发散。
### 2.2 关键代码片段
```python
# 显式差分法核心代码
def basic_heat_diffusion():
    """任务1: 基本热传导模拟"""

    r = D*dt/(dx**2)
    print(f"任务1 - 稳定性参数 r = {r}")
    
    u = np.zeros((Nx, Nt))
    u[:, 0] = 100
    u[0, :] = 0
    u[-1, :] = 0
    
    for j in range(Nt-1):
        u[1:-1, j+1] = (1-2*r)*u[1:-1, j] + r*(u[2:, j] + u[:-2, j])
    
    return u

def heat_diffusion_with_cooling():
    """任务5: 包含牛顿冷却定律的热传导"""
    r = D*dt/(dx**2)
    h = 0.1  # 冷却系数
    print(f"任务5 - 稳定性参数 r = {r}, 冷却系数 h = {h}")
    
    Nx = int(L/dx) + 1
    Nt = 100
    
    u = np.zeros((Nx, Nt))
    u[:, 0] = 100
    u[0, :] = 0
    u[-1, :] = 0
    
    for j in range(Nt-1):
        u[1:-1, j+1] = (1-2*r-h*dt)*u[1:-1, j] + r*(u[2:, j] + u[:-2, j])
    
    # 可视化
    plot_3d_solution(u, dx, dt, Nt, title='Task 5: Heat Diffusion with Newton Cooling')

# 插入你认为的关键代码段
```

## 3. 实验结果

### 3.1 显式差分法数值解

![数值解](https://github.com/user-attachments/assets/a7e103c6-f4a8-4d74-a6a3-53a70105dd37)


### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

![解析解](https://github.com/user-attachments/assets/28accef6-8a5a-4f18-b6f7-7e14b261e61e)


### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

![发散解](https://github.com/user-attachments/assets/c364a385-d9a8-456c-94d1-5ad09e7cfda0)

![数值解](https://github.com/user-attachments/assets/eba6d2a9-e6d9-4c78-9114-1c86c51ac855)

### 3.4 不同初始条件模拟

![不同初始条件温度含时演化](https://github.com/user-attachments/assets/0984817f-994f-4e06-a512-aa53624936af)

### 3.5 包含牛顿冷却定律的模拟
![牛顿冷却模型](https://github.com/user-attachments/assets/b2bfc608-a785-4346-b2b5-b0c6ebe2e43d)

## 4. 分析与讨论

1. **稳定性问题：** [描述在实现显式差分法时遇到的稳定性问题]在稳定参数大于0.5时，数值解开始震荡发散，呈现非物理的指数增长的发散情况，误差在一次次的迭代当中被指数放大。边界处也会震荡，边界处的数值形成反射波，表现为从边界向内部传播。时间步长与空间分辨率产生冲突，需要小步长保持稳定，但是导致计算成本剧增。
2. **精度问题：** [描述显示差分法精度相关的困难和改进方法]时间步长的阶数是一阶的，空间步长是二阶的，若需要增加精度，并保持时空精度相同，那么时间精度需要变化平方倍。当计算资源有限时，优先减小空间步长Δx；当精度要求严格时，采用紧致格式；面对不连续问题时，FCT算法是最稳健的选择。显式方法的本质精度限制使其在超高精度需求场景下，最终仍需转向隐式或半隐式方法。

## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
   [你的分析和解释]
离散格式破坏了物理系统的能量耗散特性。当r>0.5时，负系数导致当前点温度对自身未来的贡献变为反向，破坏了物理系统的单调衰减特性，负系数导致当前点温度对自身未来的贡献变为反向，破坏了物理系统的单调衰减特性，变为震荡特性，放大高频项。
2. **如何从物理角度理解稳定性条件的含义？**
   [你的物理直觉解释]热量在介质中以有限速度扩散，单个时间步内的热扰动最多只能传播一个网格间距。温度变化必须由邻近区域的热流引起，如果稳定参数>0.5，某点的温度变化 u_i^{n+1} 过度依赖非相邻区域，导致“超距作用”被错误体现。可将热传导视为多米诺骨牌，骨牌倾倒，热量传递，若r过大，就会导致失稳，倾倒速度过快，导致能量越级传递，导致能量在中间不断反弹，出现有违热传导方向的伪过程。
