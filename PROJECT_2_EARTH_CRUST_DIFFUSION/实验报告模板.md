# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [李名飞]

**学号：** [20231050184]

**完成日期：** [6.11]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

  
时变边界条件的影响：地表温度受季节变化驱动（正弦周期变化），研究这种时变边界如何影响地下温度分布。
显式差分格式的特性：分析显式方法的稳定性条件（如CFL条件）及其精度限制。
地球科学中的热传导现象：模拟地壳中热量随深度的衰减和相位滞后现象，解释实际观测（如土壤温度的年变化）。

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律


## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
- 空间和时间离散化方案
  空间离散化：

将深度范围 [0, 20m] 划分为等间距网格
空间步长：h = 1.0 m（默认值）
网格点数：M = int(DEPTH_MAX/h) + 1 = 21
空间索引：i = 0（地表）到 i = M-1（20m深处）
时间离散化：
将1年周期（365天）划分为等时间步长
时间步长：a = 1.0 day（默认值）
时间步数：N = int(TAU) + 1 = 36
时间索引：j = 0（初始）到 j = N-1（第365天）
- 差分方程的具体形式
空间导数（二阶中心差分）：
时间导数：
![屏幕截图 2025-06-11 120729](https://github.com/user-attachments/assets/020a09c6-2233-48f3-82ad-721c37c7088f)

- 边界条件的处理方法
  地表边界（Dirichlet条件）：
T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
  底部边界（Dirichlet条件）
  T[-1, :] = T_BOTTOM  # 在整个时间维度上保持恒定
  初始条件：
  T = np.full((M, N), T_INITIAL)
- 稳定性条件的考虑
  r = h * D / a**2

**稳定性分析：**

[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- r值为0.1
- 时间步长选择的限制条件
  对于热传导方程的显式有限差分格式，其稳定性由CFL条件（Courant-Friedrichs-Lewy条件）决定：
  ![屏幕截图 2025-06-11 123234](https://github.com/user-attachments/assets/81d2209f-5fd6-44fc-9940-d934b4817ae6)


- 

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
- 时间步数: $n_t$ =  [3650]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.1]

### 4.2 图表结果：季节性温度轮廓图
![屏幕截图 2025-06-11 110936](https://github.com/user-attachments/assets/58c2900f-2859-446e-91b1-4163f6a5e500)

[在此粘贴季节性温度轮廓图图片]

**图表分析：**
- 描述四个季节温度轮廓的差异
- 分析温度振幅随深度的衰减规律
- 讨论季节性影响的穿透深度
相位滞后现象：
地表峰值（春季）→ 5m深度峰值滞后约58天（夏季）
地表谷值（秋季）→ 5m深度谷值滞后至冬季
物理机制：热扰动以有限速度（$\sqrt{D/\omega}$）向地下传播
轮廓形态变化：
浅层（<5m）：陡峭梯度，季节差异显著（ΔT≈15°C）
中层（5-10m）：平缓变化，季节差异缩小（ΔT≈2°C）
深层（>10m）：准水平线，季节差异消失
交叉现象：
在3-4m深度附近，春夏曲线与秋冬曲线交叉
原因：浅层响应当前季节，深层仍保持上一季节温度
衰减特征：
衰减深度：$d = \sqrt{\frac{D\tau}{\pi}} \approx 3.41\text{m}$
每增加3.41m，振幅衰减为原值的1/e（≈37%）
5m处：振幅衰减至地表值的18%
10m处：振幅衰减至地表值的4%
幂律关系：$\ln(B/B_0) \propto -z$（半对数坐标呈直线）
---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[分析模拟结果揭示的物理现象：]
1. 热扩散的延迟效应（相位滞后）
现象描述：
地表温度变化信号向地下传播时存在显著时间延迟
深度每增加1米，温度极值出现时间延迟约18-20天
物理机制：
热扰动以有限速度 $v_p = \sqrt{4\pi D/\tau} \approx 0.034$ m/day 传播，导致深层温度响应滞后
2. 振幅指数衰减
现象描述：
地表温度振幅 $B_0=12°C$
5m深度振幅衰减至 $2.2°C$（衰减82%）
10m深度振幅 $<0.5°C$（衰减96%）
热扩散过程将时变边界条件转化为空间衰减的温度波，形成具有热惯性的温度剖面，这种物理机制是地表-地下能量交换的基础，深刻影响着气候系统、生态系统和人类工程活动。
### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   [你的回答]
热扩散的能量衰减效应
数学本质：热传导方程的解为衰减波
能量视角：热波动在介质中传播时：
机械能→热能（粘性耗散）
波前扩散→能量密度降低
相长干涉减弱
深层土壤柱的热容随深度指数增长

地热能利用系统
古气候重建
生态系统管理
3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   [你的回答]
显式差分格式的核心优势
算法简单直观
实现简单
无矩阵求解
避免求解线性方程组
不涉及矩阵存储（节省内存75%+）
实时可视化
每步计算后即时显示结果
适合教学和快速原型开发
隐式：应用场景：
高分辨率模拟
高扩散系数材料

---

## 6. 核心代码片段（可选）

```python
# import numpy as np
import matplotlib.pyplot as plt

# 物理常数
D = 0.1  # 热扩散率 (m^2/day)
A = 10.0  # 年平均地表温度 (°C)
B = 12.0  # 地表温度振幅 (°C)
TAU = 365.0  # 年周期 (days)
T_BOTTOM = 11.0  # 20米深处温度 (°C)
T_INITIAL = 10.0  # 初始温度 (°C)
DEPTH_MAX = 20.0  # 最大深度 (m)

def solve_earth_crust_diffusion(h=1, a=1, years=10):
    """求解地壳热扩散方程"""
    # 计算网格点数和时间步数
    M = int(DEPTH_MAX / h) + 1
    N = int(TAU) + 1
    
    # 计算稳定性参数
    r = h * D / a**2
    print(f"稳定性参数 r = {r:.4f}")
    
    # 初始化温度矩阵
    T = np.full((M, N), T_INITIAL)
    T[-1, :] = T_BOTTOM  # 底部边界条件
    
    # 时间步进循环
    for _ in range(years):
        for j in range(N-1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
            
            # 显式差分格式
            T[1:-1, j+1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2*T[1:-1, j])
    
    # 创建深度数组
    depth = np.linspace(0, DEPTH_MAX, M)
    
    return depth, T

def plot_seasonal_profiles(depth, temperature):
    """绘制季节性温度轮廓"""
    plt.figure(figsize=(10, 8))
    
    # 绘制四季温度轮廓
    seasons = [90, 180, 270, 365]
    for day in seasons:
        plt.plot(depth, temperature[:, day], label=f'Day {day}', linewidth=2)
    
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()
    plt.show()

if __name__ == "__main__":
    # 运行模拟
    depth, T = solve_earth_crust_diffusion()
    
    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)

```

